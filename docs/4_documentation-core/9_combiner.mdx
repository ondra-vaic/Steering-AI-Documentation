---
sidebar_position: 9
---

# Combiner

Combiner is an implementation of `ICombineJobWrapper`. It is the last step that the `BaseSteeringSystem` does. Its resposibility is to for each entity, take all its results from all the system's behaviors and turn it into one final result for the movement system. By default, this is:

- `VelocityResult` - *result which behaviors output per entity*
- `DesiredVelocity` - *final result attached as component on the entity telling the movement system where the entity wants to go*
- `CombineVelocitiesJobWrapper` - *implementation of `ICombineJobWrapper`*

It is however entirely possible to use your own types instead of `VelocityResult` and `DesiredVelocity`. The implementation should declare the types it works with in attributes. For example this is the declaration of `CombineVelocitiesJobWrapper`:

```csharp title="CombineVelocitiesJobWrapper.cs"
[JobWrapper(typeof(DesiredVelocityComponent))]
[OutData(typeof(VelocityResults))]
public class CombineVelocitiesJobWrapper : ICombineJobWrapper
{
    public JobHandle Schedule(
        SystemBase system,
        in BaseBehaviorParams baseBehaviorParams,
        in IDelayedDisposable[] results,
        JobHandle dependency) { ... }
}
```

The interface receives an array of data structures containing results. The results should be castable into whichever type is declared in the `OutData` attribute. For example in `CombineVelocitiesJobWrapper`, they are cast into `VelocityResults` which is just a wrapper struct for `NativeArray<VelocityResult>`. 

## Behavior Combiner Compatibility

If a combiner is declared as accepting `VelocityResults` and a behavior as outputting `VelocityResults`, then they are compatible. When a combiner is selected in the editor, only compatible behaviors will be shown as possibilities. This prevents issues when casting from the `IDelayedDisposable`. As usual, the editor will also add whichever component is declared in the `JobWrapper` as the entity's dependency. 
