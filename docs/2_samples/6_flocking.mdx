---
sidebar_position: 6
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import useBaseUrl from '@docusaurus/useBaseUrl';

# 6. Flocking

<video controls width="800">
  <source src={useBaseUrl("/videos/samples/flocking/3D.mp4")} type="video/mp4" />
  Your browser does not support the video tag.
</video>
*Flocking with 3D movement.*

This sample explains usage of [neighbor behaviors](/docs/documentation-core/behaviors/neighbor-behaviors/intro) through classical use case - [flocking](https://en.wikipedia.org/wiki/Flocking). Flocking here is the combination of three behaviors - [*Alignment*](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment), [*Cohesion*](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion), and [*Separation*](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation). All these behaviors are included in the [default behaviors](/docs/category/neighbor-behaviors-1). 

The first folder - *1. Behaviors* contains a scene for each behavior where the behavior is visualized and a scene where the combination of the behaviors is visualized. Then there is a sample scene with flocking for each [movement system](/docs/category/movement). For example folder *2. 2D*. 

<img src={useBaseUrl("/img/samples/flocking/Folder.png")} alt="Description of the image"/>

-----

## 1. Behaviors
 
:::tip
    All movement systems and behaviors can be toggled with an `IsActive` flag. In the following scenes, the `IsActive` is set to false on the [`Movement2DAuthoring`](/docs/documentation-defaults/movement/0_2D-movement) to make it easier to understand. 
:::

<Tabs>
  <TabItem value="first" label="Cohesion"> 

    This scene visualizes the result of the [`CohesionJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion). This behavior makes the entity group up with it's neighbors. The yellow arrow visualizes [`VelocityResult`](/docs/documentation-defaults/behaviors/VelocityResult). The direction is `DesiredDirection`, the length is proportional to `DirectionDesire`. The radius where the behavior detects neighbors is shown with the yellow circle.

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/cohesion.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>

  </TabItem>

  <TabItem value="first2" label="Separation"> 

    This scene visualizes the result of the [`SeparationJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation). It seperates the entity from it's neighbors.

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/separation.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>

  </TabItem>

    <TabItem value="first1" label="Alignment"> 
    
    This scene visualizes the result of the [`AlignmentJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment). It aligns the entity's direction with it's neighbors. 

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/alignment.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>

  </TabItem>

  <TabItem value="first3" label="Combination"> 

    This scene visualizes the combination of all three behaviors responsible for flocking - [`CohesionJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion), [`AlignmentJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment), [`SeparationJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation).

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/all-three.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>

  </TabItem>

  <TabItem value="second" label="Steering System Asset"> 

    **FlockingBehaviorsSteeringAsset**:
    - ***Main Tag*** - `_6_SampleBehaviorsTagComponent`
    - ***Neighbor Behaviors*** - [[`CohesionJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion), [`AlignmentJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment), [`SeparationJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation)]
    - ***Prefab*** - *EntityFlocking*

    :::note
    All the scenes in the *1. Behaviors* folder share this [`SteeringSystemAsset`](/docs/documentation-core/base-system/SteeringSystemAsset), because all the entities share the `_6_SampleBehaviorsTagComponent` tag. 
    :::

    **Neighbor Behaviors**

    <img src={useBaseUrl("/img/samples/flocking/Asset.png")} alt="Description of the image"/>

  </TabItem>
  
  <TabItem value="third" label="Prefab"> 

    **Behavior Components**:
    - [`CohesionAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion#cohesioncomponent)
    - [`AlignmentAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment#alignmentcomponent)
    - [`SeparationAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation#separationcomponent)

    **Other Components**:
    - [`SteeringEntityAuthoring`](/docs/documentation-core/base-system/steering-entity)
    - [`DesiredVelocityAuthoring`](/docs/documentation-defaults/merger#desiredvelocitycomponent)
    - [`Movement2DAuthoring`](/docs/documentation-defaults/movement/0_2D-movement)
    - [`BoxLimiterAuthoring`](/docs/documentation-defaults/utilities/box-limiter)
    
    :::note
    It does not matter that the scenes use different prefabs than the one referenced in *FlockingBehaviorsSteeringAsset*, as long as their [`SteeringEntityAuthoring`](/docs/documentation-core/base-system/steering-entity) has `_6_SampleBehaviorsTagComponent`.
    :::
    <img src={useBaseUrl("/img/samples/flocking/Prefab.png")} alt="Description of the image"/>

  </TabItem>
</Tabs>
-----

## 2. 2D

<Tabs>
  <TabItem value="first" label="Scene"> 

    **2D Movement**
    
    In this scene you can toggle multiple different [subscenes](https://docs.unity3d.com/Packages/com.unity.entities@1.3/manual/conversion-subscenes.html) which have different setups of [`CohesionAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion#cohesioncomponent), [`AlignmentAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment#alignmentcomponent), [`SeparationAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation#separationcomponent). If an entity goes over a border set on [`BoxLimiterAuthoring`](/docs/documentation-defaults/utilities/box-limiter), it is teleported to the oposite side. 

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/2D.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
    
  </TabItem>
  
  <TabItem value="second" label="Steering System Asset"> 

    **Flocking2DSystemAsset**:
    - ***Main Tag*** - `_6_Sample2DTagComponent`
    - ***Neighbor Behaviors*** - [[`CohesionJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion), [`AlignmentJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment), [`SeparationJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation)]
    - ***Simple Behaviors*** - [[`GoForwardJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward)]
    - ***Prefab*** - *EntityFlocking*

    **Neighbor Behaviors**

    <img src={useBaseUrl("/img/samples/flocking/Asset.png")} alt="Description of the image"/>

    **Simple Behaviors**

    :::warning
    [`GoForwardJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward) makes entity keep movement direction with constant speed. It is crucial to have at least one behavior which returns [`VelocityResult`](/docs/documentation-defaults/behaviors/VelocityResult) with positive `DesiredSpeed` and `SpeedDesire`. Otherwise the entities will not move anywhere.
    :::

    <img src={useBaseUrl("/img/samples/flocking/Asset2.png")} alt="Description of the image"/>

  </TabItem>
  
  <TabItem value="third" label="Prefab"> 
    
    **Behavior Components**:
    - [`CohesionAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion#cohesioncomponent)
    - [`AlignmentAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment#alignmentcomponent)
    - [`SeparationAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation#separationcomponent)
    - [`GoForwardAuthoring`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward#goforwardcomponent)

    **Other Components**:
    - [`SteeringEntityAuthoring`](/docs/documentation-core/base-system/steering-entity)
    - [`DesiredVelocityAuthoring`](/docs/documentation-defaults/merger#desiredvelocitycomponent)
    - [`Movement2DAuthoring`](/docs/documentation-defaults/movement/0_2D-movement)
    - [`BoxLimiterAuthoring`](/docs/documentation-defaults/utilities/box-limiter)
    
    <img src={useBaseUrl("/img/samples/flocking/Prefab.png")} alt="Description of the image"/>

  </TabItem>
</Tabs>
----

## 3. 3D

<Tabs>
  <TabItem value="first" label="Scene"> 
    
    **3D Movement**
    
    In this scene there are three different [subscenes](https://docs.unity3d.com/Packages/com.unity.entities@1.3/manual/conversion-subscenes.html) containing flocks of different sizes. The larger flock has a more optimized, but simpler [neighbor query](/docs/documentation-core/queries/neighbor_queries/overview). This scene also shows usefullness of [`MultiHomingAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/multi-homing) which makes the entities stay within given areas. In the subscenes, the larger the flocks, the larger the homing radii on the [`HomingComponent`](/docs/documentation-defaults/behaviors/neighbor-behaviors/multi-homing#homecomponent)s. Second new behavior is [`AlignUpJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/align-up), it prevents the entities from flying up or down at too steep angle. 

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/3D.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>

  </TabItem>
  
  <TabItem value="second" label="Steering System Asset"> 

    **Flocking3DHugeSystemAsset**:
    - ***Main Tag*** - `_6_Sample3DLargeTagComponent`
    - ***Neighbor Behaviors*** - [[`CohesionJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion), [`AlignmentJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment), [`SeparationJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation), [`MultiHomingAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/multi-homing)]
    - ***Simple Behaviors*** - [[`GoForwardJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward), [`AlignUpJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/align-up)]
    - ***Prefab*** - *EntityFlockingHuge*

    **Neighbor Behaviors**

    <img src={useBaseUrl("/img/samples/flocking/3d/Asset.png")} alt="Description of the image"/>

    **Simple Behaviors**

    :::warning
    [`GoForwardJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward) makes entity keep movement direction with constant speed. It is crucial to have at least one behavior which returns [`VelocityResult`](/docs/documentation-defaults/behaviors/VelocityResult) with positive `DesiredSpeed` and `SpeedDesire`. Otherwise the entities will not move anywhere.
    :::

    <img src={useBaseUrl("/img/samples/flocking/3d/Asset2.png")} alt="Description of the image"/>

  </TabItem>
   
  <TabItem value="third" label="Prefab"> 
    
    **Behavior Components**: 
    - [`GoForwardAuthoring`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward#goforwardcomponent)
    - [`AlignUpAuthoring`](/docs/documentation-defaults/behaviors/simple-behaviors/align-up#alignupcomponent)
    - [`CohesionAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion#cohesioncomponent)
    - [`AlignmentAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment#alignmentcomponent)
    - [`SeparationAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation#separationcomponent)
    - [`MultiHomingAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/multi-homing)

    **Other Components**:
    - [`SteeringEntityAuthoring`](/docs/documentation-core/base-system/steering-entity)
    - [`DesiredVelocityAuthoring`](/docs/documentation-defaults/merger#desiredvelocitycomponent)
    - [`Movement3DAuthoring`](/docs/documentation-defaults/movement/1_3D-movement)
    
    <img src={useBaseUrl("/img/samples/flocking/3d/Prefab.png")} alt="Description of the image"/>

  </TabItem> 
</Tabs>
----

## 4. 2.5D

<Tabs>
  <TabItem value="first" label="Scene"> 
    
    **2.5D Movement**
    
    This scene shows a flock set up on terrain, bordered by walls. The walls are a third option so far to constraint the entities within an area. The previous two options were [`BoxLimiterAuthoring`](/docs/documentation-defaults/utilities/box-limiter) and [`MultiHomingAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/multi-homing).

    <video controls width="800">
      <source src={useBaseUrl("/videos/samples/flocking/25D.mp4")} type="video/mp4" />
      Your browser does not support the video tag.
    </video>

  </TabItem>
  
  <TabItem value="second" label="Steering System Asset"> 

    **Flocking25DSystemAsset**:
    - ***Main Tag*** - `_6_Sample25TagComponent`
    - ***Neighbor Behaviors*** - [[`CohesionJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion), [`AlignmentJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment), [`SeparationJobWrapper`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation)]
    - ***Simple Behaviors*** - [[`GoForwardJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward)]
    - ***Prefab*** - *EntityFlocking*

    **Neighbor Behaviors**
 
    <img src={useBaseUrl("/img/samples/flocking/25d/Asset.png")} alt="Description of the image"/>

    **Simple Behaviors**

    :::warning
    [`GoForwardJobWrapper`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward)makes entity keep movement direction with constant speed. It is crucial to have at least one behavior which returns [`VelocityResult`](/docs/documentation-defaults/behaviors/VelocityResult) with positive `DesiredSpeed` and `SpeedDesire`. Otherwise the entities will not move anywhere.
    :::

    <img src={useBaseUrl("/img/samples/flocking/25d/Asset2.png")} alt="Description of the image"/>

  </TabItem>
  
  <TabItem value="third" label="Prefab"> 
    
    **Behavior Components**:
    - [`CohesionAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/cohesion#cohesioncomponent)
    - [`AlignmentAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/alignment#alignmentcomponent)
    - [`SeparationAuthoring`](/docs/documentation-defaults/behaviors/neighbor-behaviors/separation#separationcomponent)
    - [`GoForwardAuthoring`](/docs/documentation-defaults/behaviors/simple-behaviors/go-foward#goforwardcomponent)

    **Other Components**:
    - [`SteeringEntityAuthoring`](/docs/documentation-core/base-system/steering-entity)
    - [`DesiredVelocityAuthoring`](/docs/documentation-defaults/merger#desiredvelocitycomponent)
    - [`Movement25DAuthoring`](/docs/documentation-defaults/movement/2_25D-movement)
    - [`KinematicBodyAuthoring`](/docs/documentation-defaults/movement/collision-resolution)
    
    <img src={useBaseUrl("/img/samples/flocking/25d/Prefab.png")} alt="Description of the image"/>
 
  </TabItem>
</Tabs>
----